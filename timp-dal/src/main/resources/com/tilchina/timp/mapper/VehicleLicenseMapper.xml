<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.tilchina.timp.mapper.VehicleLicenseMapper">	<resultMap id="BaseResultMap" type="com.tilchina.timp.model.VehicleLicense">		<id column="LICENSE_ID" jdbcType="BIGINT" property="licenseId"/>		<result column="LICENSE_ID" jdbcType="BIGINT" property="licenseId"/>		<result column="VEHICLE_ID" jdbcType="BIGINT" property="vehicleId"/>		<result column="LICENSE_NUMBER" jdbcType="VARCHAR" property="licenseNumber"/>		<result column="LICENSE_TYPE" jdbcType="INTEGER" property="licenseType"/>		<result column="START_VALID_DATE" jdbcType="TIMESTAMP" property="startValidDate"/>		<result column="END_VALID_DATE" jdbcType="TIMESTAMP" property="endValidDate"/>		<result column="LICENSE_STATUS" jdbcType="INTEGER" property="licenseStatus"/>		<result column="CREATOR" jdbcType="BIGINT" property="creator"/>		<result column="CREATE_DATE" jdbcType="TIMESTAMP" property="createDate"/>		<result column="CHECKER" jdbcType="BIGINT" property="checker"/>		<result column="CHECK_DATE" jdbcType="TIMESTAMP" property="checkDate"/>		<result column="CORP_ID" jdbcType="BIGINT" property="corpId"/>		<result column="FLAG" jdbcType="INTEGER" property="flag"/>	</resultMap>	<sql id="Base_Column_List">		LICENSE_ID, VEHICLE_ID, LICENSE_NUMBER, LICENSE_TYPE, START_VALID_DATE, END_VALID_DATE, LICENSE_STATUS, CREATOR, CREATE_DATE,		CHECKER, CHECK_DATE, CORP_ID, FLAG	</sql>	<sql id="Example_Where_Clause">		where del = 0		<trim suffixOverrides=",">			<if test="licenseId != null and licenseId != ''">				and LICENSE_ID = #{licenseId}			</if>			<if test="vehicleId != null and vehicleId != ''">				and VEHICLE_ID = #{vehicleId}			</if>			<if test="licenseNumber != null and licenseNumber != ''">				and (LICENSE_NUMBER = #{licenseNumber} or LICENSE_NUMBER like concat('%', #{licenseNumber}, '%'))			</if>			<if test="licenseType != null and licenseType != ''">				and LICENSE_TYPE = #{licenseType}			</if>			<if test="startValidDate != null and startValidDate != ''">				and START_VALID_DATE = #{startValidDate}			</if>			<if test="endValidDate != null and endValidDate != ''">				and END_VALID_DATE = #{endValidDate}			</if>			<if test="licenseStatus != null and licenseStatus != ''">				and LICENSE_STATUS = #{licenseStatus}			</if>			<if test="creator != null and creator != ''">				and CREATOR = #{creator}			</if>			<if test="createDate != null and createDate != ''">				and CREATE_DATE = #{createDate}			</if>			<if test="checker != null and checker != ''">				and CHECKER = #{checker}			</if>			<if test="checkDate != null and checkDate != ''">				and CHECK_DATE = #{checkDate}			</if>			<if test="corpId != null and corpId != ''">				and CORP_ID = #{corpId}			</if>			<if test="flag != null and flag != ''">				and FLAG = #{flag}			</if>		</trim>	</sql>	<select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long">		select		<include refid="Base_Column_List"/>		from tc_vehicle_license		where LICENSE_ID = #{licenseId,jdbcType=BIGINT}	</select>	<delete id="deleteByPrimaryKey" parameterType="java.lang.Long">		delete from tc_vehicle_license		where LICENSE_ID = #{licenseId}	</delete>	<insert id="insert" parameterType="com.tilchina.timp.model.VehicleLicense" keyProperty="licenseId"	        useGeneratedKeys="true">		insert into tc_vehicle_license		(VEHICLE_ID, LICENSE_NUMBER, LICENSE_TYPE, START_VALID_DATE, END_VALID_DATE, LICENSE_STATUS, CREATOR, CREATE_DATE, CHECKER,		 CHECK_DATE, CORP_ID, FLAG)		values			(#{vehicleId,jdbcType=BIGINT}, #{licenseNumber,jdbcType=VARCHAR}, #{licenseType,jdbcType=INTEGER},			                               #{startValidDate,jdbcType=TIMESTAMP},			                               #{endValidDate,jdbcType=TIMESTAMP}, #{licenseStatus,jdbcType=INTEGER},			                               #{creator,jdbcType=BIGINT},			                               #{createDate,jdbcType=TIMESTAMP}, #{checker,jdbcType=BIGINT},			                               #{checkDate,jdbcType=TIMESTAMP}, #{corpId,jdbcType=BIGINT},			 #{flag,jdbcType=INTEGER})	</insert>	<insert id="insertSelective" parameterType="com.tilchina.timp.model.VehicleLicense" keyProperty="licenseId"	        useGeneratedKeys="true">		insert into tc_vehicle_license		<trim prefix="(" suffix=")" suffixOverrides=",">			<if test="vehicleId != null">				VEHICLE_ID,			</if>			<if test="licenseNumber != null">				LICENSE_NUMBER,			</if>			<if test="licenseType != null">				LICENSE_TYPE,			</if>			<if test="startValidDate != null">				START_VALID_DATE,			</if>			<if test="endValidDate != null">				END_VALID_DATE,			</if>			<if test="licenseStatus != null">				LICENSE_STATUS,			</if>			<if test="creator != null">				CREATOR,			</if>			<if test="createDate != null">				CREATE_DATE,			</if>			<if test="checker != null">				CHECKER,			</if>			<if test="checkDate != null">				CHECK_DATE,			</if>			<if test="corpId != null">				CORP_ID,			</if>			<if test="flag != null">				FLAG,			</if>		</trim>		<trim prefix="values (" suffix=")" suffixOverrides=",">			<if test="vehicleId != null">				#{vehicleId,jdbcType=BIGINT},			</if>			<if test="licenseNumber != null">				#{licenseNumber,jdbcType=VARCHAR},			</if>			<if test="licenseType != null">				#{licenseType,jdbcType=INTEGER},			</if>			<if test="startValidDate != null">				#{startValidDate,jdbcType=TIMESTAMP},			</if>			<if test="endValidDate != null">				#{endValidDate,jdbcType=TIMESTAMP},			</if>			<if test="licenseStatus != null">				#{licenseStatus,jdbcType=INTEGER},			</if>			<if test="creator != null">				#{creator,jdbcType=BIGINT},			</if>			<if test="createDate != null">				#{createDate,jdbcType=TIMESTAMP},			</if>			<if test="checker != null">				#{checker,jdbcType=BIGINT},			</if>			<if test="checkDate != null">				#{checkDate,jdbcType=TIMESTAMP},			</if>			<if test="corpId != null">				#{corpId,jdbcType=BIGINT},			</if>			<if test="flag != null">				#{flag,jdbcType=INTEGER},			</if>		</trim>	</insert>	<update id="updateByPrimaryKeySelective" parameterType="com.tilchina.timp.model.VehicleLicense">		update tc_vehicle_license		<set>			<if test="vehicleId != null">				VEHICLE_ID = #{vehicleId,jdbcType=BIGINT},			</if>			<if test="licenseNumber != null">				LICENSE_NUMBER = #{licenseNumber,jdbcType=VARCHAR},			</if>			<if test="licenseType != null">				LICENSE_TYPE = #{licenseType,jdbcType=INTEGER},			</if>			<if test="startValidDate != null">				START_VALID_DATE = #{startValidDate,jdbcType=TIMESTAMP},			</if>			<if test="endValidDate != null">				END_VALID_DATE = #{endValidDate,jdbcType=TIMESTAMP},			</if>			<if test="licenseStatus != null">				LICENSE_STATUS = #{licenseStatus,jdbcType=INTEGER},			</if>			<if test="creator != null">				CREATOR = #{creator,jdbcType=BIGINT},			</if>			<if test="createDate != null">				CREATE_DATE = #{createDate,jdbcType=TIMESTAMP},			</if>			<if test="checker != null">				CHECKER = #{checker,jdbcType=BIGINT},			</if>			<if test="checkDate != null">				CHECK_DATE = #{checkDate,jdbcType=TIMESTAMP},			</if>			<if test="corpId != null">				CORP_ID = #{corpId,jdbcType=BIGINT},			</if>			<if test="flag != null">				FLAG = #{flag,jdbcType=INTEGER},			</if>		</set>		where LICENSE_ID = #{licenseId,jdbcType=BIGINT}	</update>	<update id="updateByPrimaryKey" parameterType="com.tilchina.timp.model.VehicleLicense">		update tc_vehicle_license		set			VEHICLE_ID       = #{vehicleId,jdbcType=BIGINT}, LICENSE_NUMBER = #{licenseNumber,jdbcType=VARCHAR},			LICENSE_TYPE     = #{licenseType,jdbcType=INTEGER},			START_VALID_DATE = #{startValidDate,jdbcType=TIMESTAMP},			END_VALID_DATE   = #{endValidDate,jdbcType=TIMESTAMP},			LICENSE_STATUS   = #{licenseStatus,jdbcType=INTEGER}, CREATOR = #{creator,jdbcType=BIGINT},			CREATE_DATE      = #{createDate,jdbcType=TIMESTAMP},			CHECKER          = #{checker,jdbcType=BIGINT}, CHECK_DATE = #{checkDate,jdbcType=TIMESTAMP},			CORP_ID          = #{corpId,jdbcType=BIGINT}, FLAG = #{flag,jdbcType=INTEGER}		where LICENSE_ID = #{licenseId,jdbcType=BIGINT}	</update>	<sql id="Query_Column_List" >		self.LICENSE_ID,		self.VEHICLE_ID,		self.LICENSE_NUMBER,		self.LICENSE_TYPE,		self.START_VALID_DATE,		self.END_VALID_DATE,		self.LICENSE_STATUS,		self.CREATOR,		self.CREATE_DATE,		self.CHECKER,		self.CHECK_DATE,		self.CORP_ID,		self.FLAG,		ts.TRANSPORTER_CODE as refVehicleCode,		ts.TRACTIR_PLATE_CODE as refTractorCode,		ts.TRAILER_PLATE_CODE as refTrailerCode,		userA.USER_NAME as refCreatorName,		userB.USER_NAME as refCheckerName,		corp.CORP_NAME as refCorpName	</sql>	<sql id="Query_Where_Clause">		where self.DEL = 0		<trim  suffixOverrides="," >			<if test="licenseId != null and licenseId != ''" >				and self.LICENSE_ID = #{licenseId}			</if>			<if test="vehicleId != null and vehicleId != ''" >				and self.VEHICLE_ID = #{vehicleId}			</if>			<if test="licenseNumber != null and licenseNumber != ''" >				and (self.LICENSE_NUMBER = #{licenseNumber} or self.LICENSE_NUMBER like concat('%', #{licenseNumber}, '%'))			</if>			<if test="licenseType != null and licenseType != ''" >				and self.LICENSE_TYPE = #{licenseType}			</if>			<if test="startValidDate != null and startValidDate != ''" >				<![CDATA[ and self.START_VALID_DATE >= #{startValidDate} ]]>			</if>			<if test="endValidDate != null and endValidDate != ''" >				<![CDATA[ and self.END_VALID_DATE < DATE_ADD(#{endValidDate}, INTERVAL 1 DAY) ]]>			</if>			<if test="licenseStatus != null and licenseStatus != ''" >				and self.LICENSE_STATUS = #{licenseStatus}			</if>			<if test="creator != null and creator != ''" >				and self.CREATOR = #{creator}			</if>			<if test="createDate != null and createDate != ''" >				and self.CREATE_DATE = #{createDate}			</if>			<if test="checker != null and checker != ''" >				and self.CHECKER = #{checker}			</if>			<if test="checkDate != null and checkDate != ''" >				and self.CHECK_DATE = #{checkDate}			</if>			<if test="corpId != null and corpId != ''" >				and self.CORP_ID = #{corpId}			</if>			<if test="flag != null and flag != ''" >				and self.FLAG = #{flag}			</if>			<if test="refVehicleCode != null and refVehicleCode != ''" >				and (ts.TRANSPORTER_CODE = #{refVehicleCode} or ts.TRANSPORTER_CODE like concat('%', #{refVehicleCode}, '%'))			</if>			<if test="refTractorCode != null and refTractorCode != ''" >				and (ts.TRACTIR_PLATE_CODE = #{refTractorCode} or ts.TRACTIR_PLATE_CODE like concat('%', #{refTractorCode}, '%'))			</if>			<if test="refTrailerCode != null and refTrailerCode != ''" >				and (ts.TRAILER_PLATE_CODE = #{refTrailerCode} or ts.TRAILER_PLATE_CODE like concat('%', #{refTrailerCode}, '%'))			</if>			<if test="startDate != null and startDate != ''">				<![CDATA[ and self.CREATE_DATE >= #{startDate} ]]>			</if>			<if test="endDate != null and endDate != ''">				<![CDATA[ and self.CREATE_DATE < DATE_ADD(#{endDate}, INTERVAL 1 DAY) ]]>			</if>			<if test="searchContent != null and searchContent != ''">				and (				ts.TRACTIR_PLATE_CODE like concat('%', #{searchContent}, '%')				or ts.TRAILER_PLATE_CODE like concat('%', #{searchContent}, '%')				or self.LICENSE_NUMBER like concat('%', #{searchContent}, '%'))			</if>		</trim>	</sql>	<select id="selectList" resultMap="BaseResultMap" parameterType="Object">		select		<include refid="Query_Column_List"/>		from tc_vehicle_license self		left join tc_transporter ts on self.VEHICLE_ID = ts.TRANSPORTER_ID		left join bd_user userA on self.CREATOR = userA.USER_ID		left join bd_user userB on self.CHECKER = userB.USER_ID		left join sys_corp corp on self.CORP_ID = corp.CORP_ID		<include refid="Query_Where_Clause"/>		order by self.CREATE_DATE DESC	</select>	<update id="setDocumentsCheckStatus" parameterType="java.util.Map">		update tc_vehicle_license		set CHECKER = #{checker},			CHECK_DATE = #{checkDate},			LICENSE_STATUS = #{licenseStatus}		where LICENSE_ID = #{licenseId}	</update>	<select id="queryForScheduledTask" parameterType="java.lang.Object" resultMap="BaseResultMap">		select		<include refid="Query_Column_List"/>		from tc_vehicle_license self		left join tc_transporter ts on self.VEHICLE_ID = ts.TRANSPORTER_ID		left join bd_user userA on self.CREATOR = userA.USER_ID		left join bd_user userB on self.CHECKER = userB.USER_ID		left join sys_corp corp on self.CORP_ID = corp.CORP_ID		<![CDATA[ where DATEDIFF(self.END_VALID_DATE, now()) <= #{max} ]]>		<![CDATA[ and DATEDIFF(self.END_VALID_DATE, now()) > #{min} ]]>		and self.FLAG = 0		and self.DEL = 0	</select>	<update id="updateExpiredLicense" parameterType="java.lang.Object">		update tc_vehicle_license		set LICENSE_STATUS = 2		<![CDATA[ where END_VALID_DATE < now() ]]>	</update>	<select id="getLicenseIdByVehicleId" parameterType="java.lang.Long" resultType="java.lang.Long">		select LICENSE_ID		from tc_vehicle_license		where VEHICLE_ID = #{vehicleId}		and FLAG = 0		and DEL = 0	</select>	<select id="getVehicleIdByLicenseId" parameterType="java.lang.Long" resultType="java.lang.Long">		select VEHICLE_ID		from tc_vehicle_license		where LICENSE_ID = #{licenseId}	    and FLAG = 0	    and DEL = 0	</select>	<select id="getLicenseByVehicleId" parameterType="java.lang.Object" resultMap="BaseResultMap">		select		<include refid="Base_Column_List"/>		from tc_vehicle_license		where VEHICLE_ID = #{vehicleId}		and LICENSE_TYPE = #{licenseType}		and LICENSE_STATUS = 1		and FLAG = 0		and DEL = 0	</select></mapper>   